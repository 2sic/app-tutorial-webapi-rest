<h2>Add an item with REST</h2>
<p>
    The following demo shows how to use create a new item using REST. It will really add data to the database. 
</p>
<p>
    This uses jQuery to do the ajax. Usually you would create a form or something, to simplify the code the code just adds a new item manually. 
</p>
<p>
    Note that it works for admins by default - to make it work for visitors you have to allow create-permissions for anonymous users (or users with view permissions). This is configured on the content-types - for more infos read <a href="http://2sxc.org/help?tag=permissions">Permissions Help</a>. 
</p>
<h2>These is where the new feedback item will be created</h2>
<a href="javascript:createFeedbackEasy([Module:ModuleId], newFeedback);">Click here to create the new item.</a>
<br>
<div id="message"></div>
<ol id="categories">
</ol>

<script>

    var newFeedback = {
        Subject: "New feedback from " + (new Date()).toISOString(),
        Message: "I love REST"
    }

    function showSuccess (data) {
        // use the data to show a message
        $('#message').html("I just created a new item in the content-database. I'm not showing it here to keep the code very simple - this could be a thank-you message after a contact form.");
    }


    function createFeedbackEasy(moduleId, newItem) {
        // the following line gets a helper object for this module. Note that the placeholder Module:ModuleId will be turned into the module number on the server
        $2sxc(moduleId).webApi.post('app/auto/content/Feedback', {}, newItem)
            .then(showSuccess);
    };

    function createFeedbackHard(moduleId, newItem) {
        // the following line gets a helper object for this module. Note that the placeholder Module:ModuleId will be turned into the module number on the server
        var moduleSxc = $2sxc(moduleId);
        var dnnSf = $.ServicesFramework(moduleId);

        // Here we ask the helper system for the full url to the REST
        var urlToFeedback = moduleSxc.resolveServiceUrl('app/auto/content/Feedback');


        $.ajax({
            type: "POST",
            url: urlToFeedback,
            data: JSON.stringify(newItem),
            contentType: "application/json",
            //dataType: 'json',
            beforeSend: dnnSf.setModuleHeaders,
            success: showSuccess,
            error: function (jqXHR, textStatus, errorThrown) {
                alert("Error:" + errorThrown);
            }
        });
    };

</script>

<!-- this includes the $2sxc helpers necessary to work --> 
<script src="/desktopmodules/tosic_sexycontent/js/2sxc.api.min.js"></script>

<!-- this script just has some tutorial-helpers, not relevant to understand the tutorial code -->
<script src="[App:Path]/assets/tutorial-helpers.js"></script>
